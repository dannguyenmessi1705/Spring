# Tạo Annotaion và Configuration trong Spring

## 1. Giới thiệu Spring Framework
**Spring Framework** là một framework phổ biến nhất trong việc phát triển ứng dụng Java. Spring Framework cung cấp một giải pháp toàn diện cho việc xây dựng ứng dụng Java Enterprise. Spring Framework cung cấp một cách linh hoạt và mạnh mẽ để xây dựng ứng dụng Java Enterprise.

Spring Framework cung cấp một số tính năng chính sau:
- **Inversion of Control (IoC)**: Spring Framework cung cấp một container để quản lý các đối tượng của ứng dụng. Container này sẽ tạo ra các đối tượng, inject các đối tượng vào các đối tượng khác, và quản lý vòng đời của các đối tượng.
- **Dependency Injection (DI)**: Spring Framework cung cấp một cách để inject các đối tượng vào các đối tượng khác. Dependency Injection giúp giảm sự phụ thuộc giữa các đối tượng trong ứng dụng.
- **Aspect-Oriented Programming (AOP)**: Spring Framework hỗ trợ Aspect-Oriented Programming. AOP giúp chia nhỏ chức năng của ứng dụng thành các phần nhỏ hơn, dễ quản lý hơn.
- **Transaction Management**: Spring Framework hỗ trợ quản lý transaction. Spring Framework cung cấp một cách để quản lý transaction một cách dễ dàng.
- **Model-View-Controller (MVC)**: Spring Framework cung cấp một cách để xây dựng ứng dụng web theo mô hình MVC.
- **Data Access**: Spring Framework hỗ trợ các cách để truy cập dữ liệu từ cơ sở dữ liệu.

## 2. Ví dụ
Trong ví dụ này, chúng ta sẽ tạo một ứng dụng Spring đơn giản.

> HelloWorld.java
```java
package com.example.demo;

import org.springframework.context.annotation.Bean; // Import Bean annotation 
import org.springframework.context.annotation.Configuration; // Import Configuration annotation

@Configuration // Đánh dấu đây là một Configuration class, nó sẽ được Spring Framework quản lý và tạo ra các Bean
public class HelloWorld {
    @Bean // Đánh dấu đây là một Bean, Spring Framework sẽ tạo ra một Bean từ phương thức này
    public String helloWorld() {
        return "Hello World!";
    }
}
```

> Main.java
```java
package com.example.demo;

import org.springframework.context.annotation.AnnotationConfigApplicationContext; // Import AnnotationConfigApplicationContext

public class Main {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(HelloWorld.class); // Tạo một AnnotationConfigApplicationContext với HelloWorld class, nó sẽ tạo ra các Bean từ HelloWorld class
        String helloWorld = context.getBean("helloWorld", String.class); // Lấy Bean có tên là "helloWorld" từ context
        System.out.println(helloWorld); // In ra màn hình, kết quả sẽ là "Hello World!"
        context.close(); // Đóng context
    }
}
```

## 3. Sử dụng Annotation để tạo Bean và Configuration
Trong Spring Framework, chúng ta có thể sử dụng các Annotation để tạo Bean và Configuration.

Thay vì dùng @Bean và @Configuration như trên, chúng ta có thể sử dụng các Annotation sau:

- **@Component**: Đánh dấu một class là một Bean.
- **@Repository**: Đánh dấu một class là một Bean, thường được sử dụng cho các class truy cập cơ sở dữ liệu.
- **@Service**: Đánh dấu một class là một Bean, thường được sử dụng cho các class chứa logic xử lý.
- **@Controller**: Đánh dấu một class là một Bean, thường được sử dụng cho các class xử lý request trong ứng dụng web.
- **@Configuration**: Đánh dấu một class là một Configuration class.

Ví dụ:

>Pacman.java
```java
package com.example.demo.game;

import org.springframework.stereotype.Component; // Import Component annotation

@Component // Đánh dấu đây là một Bean
public class Pacman {
    public void play() {
        System.out.println("Pacman is playing!");
    }
}
```

> Main.java
```java
package com.example.demo;

import org.springframework.context.annotation.AnnotationConfigApplicationContext; // Import AnnotationConfigApplicationContext
import org.springframework.context.annotation.ComponentScan; // Import ComponentScan annotation, sử dụng để quét các Bean

@Configuration // Đánh dấu đây là một Configuration class
@ComponentScan("com.example.demo.game") // Quét các Bean trong package com.example.demo.game và package con của nó
public class Main() {
    public static void main(String[] args) {
        try (var context = new AnnotationConfigApplicationContext(Main.class)) { // Tạo một AnnotationConfigApplicationContext với Main class, nó sẽ tạo ra các Bean từ Main class
            var game = context.getBean(Pacman.class); // Lấy Bean có kiểu là Pacman từ context
            pacman.play(); // Gọi phương thức play() của Bean
        }
    }
}
```

## 4. Import Dependency Injection trong Spring
Việc sử dụng Dependency Injection trong Spring Framework giúp giảm sự phụ thuộc giữa các đối tượng trong ứng dụng.
 
Chúng ta có thể sử dụng các Annotation sau để inject các đối tượng vào các đối tượng khác:
- **@Autowired**: Đánh dấu một thuộc tính, setter method, hoặc constructor để Spring Framework inject một Bean vào đó.
- **@Qualifier**: Đánh dấu một Bean để chỉ định Bean cụ thể sẽ được inject.

Có những cách sau để inject các đối tượng vào các đối tượng khác:
- **Constructor Injection**: Inject các đối tượng thông qua constructor. (nên sử dụng cách này)
- **Setter Injection**: Inject các đối tượng thông qua setter method. (Sử dụng Annotation @Autowired)
- **Field Injection**: Inject các đối tượng thông qua thuộc tính. (Sử dụng Annotation @Autowired)

Ví dụ:
> Hello.java
```java
package com.example.demo;

import org.springframework.stereotype.Component; // Import Component annotation

@Component // Đánh dấu đây là một Bean
public class Hello {
    // - **Constructor Injection**: Inject các đối tượng thông qua constructor
    private final Vietnamese vietnamese;
    public Hello(Vietnamese vietnamese) {
        super();
        this.vietnamese = vietnamese; // Inject Vietnamese Bean vào Hello Bean thông qua constructor
    }

    // - **Setter Injection**: Inject các đối tượng thông qua setter method
    private English english;
    @Autowired // Đánh dấu đây là một Bean sẽ được inject
    public void setEnglish(English english) {
        this.english = english; // Inject English Bean vào Hello Bean thông qua setter method
    }

    // - **Field Injection**: Inject các đối tượng thông qua thuộc tính
    @Autowired // Đánh dấu đây là một Bean sẽ được inject
    private Vietnamese vietnamese; // Inject Japanese Bean vào Hello Bean thông qua thuộc tín
}

@Component // Đánh dấu đây là một Bean
class English {
    public String display() {
        return "Hello World!";
    }
}

@Component // Đánh dấu đây là một Bean
class Vietnamese {
    public String display() {
        return "Xin chào!";
    }
}
```

## 5. So sánh @Component và @Bean
| @Component | @Bean |
|------------|-------|
| Đánh dấu một class là một Bean | Đánh dấu một phương thức là một Bean |
| Dễ sử dụng hơn qua việc thêm Annotation vào class | Phải viết nhiều code hơn |
| Inject các đối tượng thông qua constructor, setter method, hoặc field | Inject các đối tượng thông qua gọi hàm hoặc parameter |
| Được tạo ra bởi Spring Framework | Được tạo ra bởi lập trình viên |
| Thiết lập Bean cho toàn bộ ứng dụng: Code @Component | Tùy chỉnh logic nghiệp vụ hoặc chỉ thiết lập Bean cho ứng dụng, thư viện bên thứ ba: Code @Bean |


## 6. Các Annotation Component trong Spring
Spring Framework cung cấp một số Annotation `Component` để chúng ta có thể sử dụng trong việc tạo Bean và Configuration.

Ngoài `@Component`, chúng ta còn có các Annotation cụ thể `@Repository`, `@Service`, `@Controller` để đánh dấu một class là một Bean. Nhưng nó hoạt động giống nhau, chỉ khác nhau ở mục đích sử dụng:
- **@Repository**: Đánh dấu một class là một Bean, thường được sử dụng cho các class truy cập cơ sở dữ liệu.
- **@Service**: Đánh dấu một class là một Bean, thường được sử dụng cho các class chứa logic xử lý.
- **@Controller**: Đánh dấu một class là một Bean, thường được sử dụng cho các class xử lý request trong ứng dụng web.

Spring khuyến khích chúng ta sử dụng các Annotation cụ thể `@Repository`, `@Service`, `@Controller` để chúng ta có thể phân biệt rõ ràng mục đích sử dụng của Bean.