# Sử dụng Unit Test và Mockito trong Spring Boot
## 1. Giới thiệu    
`Unit Test` là một loại kiểm thử phần mềm mà ở đó các đơn vị hoặc thành phần của phần mềm được kiểm tra một cách riêng lẻ. Mục tiêu của `Unit Test` là kiểm tra xem mỗi đơn vị hoặc thành phần của phần mềm hoạt động đúng như mong đợi hay không. `Unit Test` giúp đảm bảo rằng mã nguồn của bạn hoạt động đúng và không bị lỗi.

`Mockito` là một thư viện giúp chúng ta tạo ra các đối tượng giả mạo (mock object) để kiểm tra các phương thức của đối tượng đó. `Mockito` giúp chúng ta kiểm tra xem một phương thức được gọi hay không, số lần gọi, tham số truyền vào, giá trị trả về,...

## 2. Sử dụng Unit Test
Trong `Spring Boot`, chúng ta có thể sử dụng `JUnit` để viết các `Unit Test`.

`JUnit` là một framework giúp chúng ta viết các `Unit Test` một cách dễ dàng. `JUnit` giúp chúng ta kiểm tra xem một phương thức hoạt động đúng như mong đợi hay không. 

Ví dụ ta có 1 phươn thức `add` trong class `Calculator`. Junits giúp chúng ta kiểm tra xem phương thức `add` có hoạt động đúng như mong đợi hay không.

Chúng ta sử dụng `JUnit Jupiter`, phiên bản `JUnit 5` để viết các `Unit Test`.

> Lưu ý: Cần phải tạo `Source Folder` mới để chứa các `Unit Test`, không nên viết `Unit Test` trong `Source Folder` chứa mã nguồn.
> Lưu ý: `File test` cần được đặt trong `cùng package` với `file cần test`.
> Lưu ý: `Unit Test` không nên phụ thuộc vào nhau, mỗi `Unit Test` nên kiểm tra một phần nhỏ của mã nguồn.

Annotation `@Test` được sử dụng để đánh dấu một phương thức là một `Unit Test`, `@BeforeEach`, `@AfterEach`, `@BeforeAll`, `@AfterAll` giúp chúng ta thực hiện các công việc trước hoặc sau khi chạy `Unit Test`.

Nếu trong `Unit Test` có phương thức `fail`, `Unit Test` sẽ báo lỗi. Mặc định nếu không có phương thức `fail`, `Unit Test` sẽ chạy thành công.

Các phương thức hay sử dụng trong `JUnit 5`:
- `assertEquals`: So sánh giá trị mong đợi với giá trị thực tế. Nếu giá trị mong đợi khác với giá trị thực tế, `Unit Test` sẽ báo lỗi. VD `assertEquals(5, calculator.add(2, 3));`
- `assertTrue`: Kiểm tra xem một điều kiện có đúng hay không. Nếu điều kiện đúng, `Unit Test` sẽ chạy thành công. VD `assertTrue(calculator.add(2, 3) == 5);`
- `assertFalse`: Kiểm tra xem một điều kiện có sai hay không. Nếu điều kiện sai, `Unit Test` sẽ chạy thành công. VD `assertFalse(calculator.add(2, 3) == 6);`
- `assertThrows`: Kiểm tra xem một ngoại lệ có được ném ra hay không. VD `assertThrows(ArithmeticException.class, () -> calculator.divide(1, 0));`

>Calculator.java
```java
package com.example.demo;

public class Calculator {
    public int add(Integer... numbers) { // Tham số đầu vào là một các dãy số nguyên phân cách bởi dấu phẩy
		int sum = 0;
		for (int i : numbers) {
			sum += i;
		}
		return sum; // Trả về tổng của các số
	}
}
```
>CalculatorTest.java
```java
package com.example.demo;

import static org.junit.jupiter.api.Assertions.*; // Import các phương thức kiểm tra của JUnit 5

import org.junit.jupiter.api.Test; // Import annotation @Test

class CalculateTest {

	@Test // Đánh dấu phương thức là một Unit Test
	void testAddCalculate() {
		Calculate calculate = new Calculate();
		int actual = calculate.add(1, 2, 3, 4);
		int expected = 10;
		
		assertEquals(expected, actual); // So sánh giá trị mong đợi với giá trị thực tế, nếu khác nhau sẽ báo lỗi
		
//		fail("Not yet implemented"); // Phương thức fail sẽ báo lỗi ngay lập tức
	}

}
