# Sử dụng JWT trong Spring Boot
## 1. Giới thiệu
`JWT (JSON Web Token)` là một chuẩn mở để truyền dữ liệu an toàn giữa hai bên dưới dạng JSON. `JWT` được sử dụng rộng rãi trong việc xác thực người dùng và truyền dữ liệu an toàn giữa các hệ thống.

`JWT` bao gồm 3 phần, mỗi phần được ngăn cách bằng dấu chấm `.`:
- Header: Chứa thông tin về loại token và thuật toán mã hóa.
    + `alg`: Thuật toán mã hóa.
    + `typ`: Loại token.
- Payload: Chứa thông tin về người dùng.
    + `sub`: Subject, chủ thể của token.
    + `exp`: Expiration time, thời gian hết hạn của token.
    + `iat`: Issued At, thời gian phát hành token.
    + `iss`: Issuer, người phát hành token.
    + `aud`: Audience, người nhận token.
- Signature: Chữ ký số để xác thực token, bao gồm header, payload và secret key.

## 2. JWT Authentication sử dụng Spring Boot's OAuth2 Resource Server
Để sử dụng `JWT` trong `Spring Boot`, chúng ta sử dụng `Spring Boot's OAuth2 Resource Server`. `Spring Boot's OAuth2 Resource Server` hỗ trợ tích hợp `OAuth2` để xác thực người dùng sử dụng `JWT`:
> `pom.xml`
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-oauth2-resource-server</artifactId>
</dependency>
```
Chúng ta thực hiện các bước sau để sử dụng `JWT` trong `Spring Boot`:
- 1. Tạo key pair: Sử dụng `java.security.KeyPairGenerator` để tạo key pair. Hoặc sử dụng `openssl` để tạo key pair.
- 2. Tạo đối tượng khóa `RSA` sử dụng key pair: Sử dụng `com.nimbusds.jose.jwk.RSAKey` để tạo đối tượng khóa `RSA`.
- 3. Tạo `JWKSource` (JSON Web Key Source) để cung cấp khóa `RSA`
    + Tạo `JWKSet` để lưu trữ khóa `RSA`.
    + Tạo `JWKSource` từ `JWKSet`.
- 4. Sử dụng khóa công khai `RSA` để giải mã token: Sử dụng `NimbusJwtDecoder.withPublicKey(rsaKey.toRSAPublicKey()).build()` để giải mã token.
- 5. Sử dụng `JWKSource` cho việc mã hóa: trả về `return new NimbusJwsEncoder(jwkSource);` trong `@Bean` của `WebSecurityConfigurerAdapter`.