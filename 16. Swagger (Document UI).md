# Sử dụng Swagger (Document UI) trong Spring Boot
## 1. Giới thiệu
`Swagger` là một công cụ giúp tạo ra tài liệu API một cách tự động và dễ dàng. Swagger giúp tạo ra một giao diện người dùng để xem và thử nghiệm các API một cách dễ dàng.

## 2. Cài đặt Swagger trong Spring Boot
Để cài đặt `Swagger` trong ứng dụng Spring Boot, lên web [Swagger](https://springdoc.org/) để tìm hiểu cách cài đặt. Cụ thể:

### 2.1. Thêm `dependency` vào `pom.xml`
```xml
   <dependency>
      <groupId>org.springdoc</groupId>
      <artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
      <version>2.5.0</version>
   </dependency>
```
Sau khi thêm `dependency`, chúng ta cần khởi động lại ứng dụng Spring Boot để `Swagger` có thể hoạt động. Nó tự động bắt đầu tạo tài liệu API từ các `Controller` trong ứng dụng.

### 2.2. Cấu hình đuờng dẫn `Swagger`
Mặc định khi chúng ta cài đặt `Swagger`, nó sẽ được cấu hình ở đường dẫn:
    - `/swagger-ui.html` - Giao diện người dùng để xem và thử nghiệm các API.
    - `/v3/api-docs` - Tài liệu API dưới dạng `JSON`.
Để cấu hình đường dẫn `Swagger`, chúng ta có thể sử dụng `application.properties` hoặc `application.yml`:
```properties
# Đường dẫn tài liệu API
springdoc.api-docs.path=/api-docs 
# Đường dẫn giao diện người dùng
springdoc.swagger-ui.path=/swagger-ui 
# Tắt cache để xem thay đổi ngay lập tức
springdoc.cache.disabled=true 
# Sắp xếp các tag theo thứ tự bảng chữ cái
springdoc.swagger-ui.tags-sorter=alpha 
# Sắp xếp các operation, api route theo thứ tự bảng chữ cái
springdoc.swagger-ui.operations-sorter=alpha 
```

## 3. Sử dụng Annotation `@OpenAPIDefinition` để định nghĩa thông tin chung cho tài liệu API
Chúng ta có thể sử dụng `@OpenAPIDefinition` để định nghĩa thông tin chung cho tài liệu API bằng cách thêm annotation này vào đầu class chính chạy ứng dụng Spring Boot:
>Application.java
```java
...
@OpenAPIDefinition( // Định nghĩa thông tin chung cho tài liệu API
	info = @Info( // Thông tin tài liệu API
		title = "Microservices Accounts API documents", // Tiêu đề tài liệu
		description = "Microservices Accounts API documents", // Mô tả tài liệu
		version = "v1", // Phiên bản tài liệu
		contact = @Contact( // Thông tin liên hệ
			name = "Nguyen Di Dan", // Tên
			url = "https://my.didan.id.vn", // URL
			email = "didannguyen17@gmail.com" // Email
		),
		license = @License( // Thông tin bản quyền
			name = "Apache 2.0", // Tên bản quyền
			url = "https://my.didan.id.vn" // URL bản quyền
		),
		summary = "Microservices Accounts API documents" // Tóm tắt tài liệu API
	),
	servers = { // Danh sách server mà API hỗ trợ
		@Server( // Server 1
			description = "Localhost", // Mô tả server
			url = "http://localhost:8080" // URL server
		),
		@Server( // Server 2
			description = "Deploy", // Mô tả server
			url = "https://deploy.com" // URL server
		)
	}
)
public class Application {...};
```

## 4. Sử dụng Annotation `@SecuritySchemes` để định nghĩa thông tin bảo mật cho tài liệu API
Chúng ta có thể sử dụng `@SecurityScheme` để định nghĩa thông tin bảo mật cho tài liệu API bằng cách thêm annotation này vào đầu class chính chạy ứng dụng Spring Boot:
>Application.java
```java
...
@SecuritySchemes({ // Danh sách thông tin bảo mật
	@SecurityScheme( // Thông tin bảo mật 1
		name = "bearerAuth", // Tên bảo mật
		type = SecuritySchemeType.HTTP, // Loại bảo mật, bao gồm: API_KEY, HTTP, OAUTH2, OPENID_CONNECT
		bearerFormat = "JWT", // Định dạng token
		scheme = "Bearer" // Scheme bảo mật (Bearer, Basic, ...)
	)
})
```

## 5. Sử dụng Annotation `@Tag`, `@Operation`, `@ApiResponse` để định nghĩa thông tin chi tiết cho các hành động API
Chúng ta có thể sử dụng `@Tag`, `@Operation`, `@ApiResponse` để định nghĩa thông tin chi tiết cho các hành động API bằng cách thêm annotation này vào các `Controller`:
>AccountController.java
```java
...
@Tag(name = "Accounts", description = "Accounts API") // Định nghĩa tag và mô tả cho API
@RestController
@RequestMapping("/api/accounts")
public class AccountController {
   @Operation( // Định nghĩa thông tin cho hành động API
      summary = "Get all accounts", // Tóm tắt hành động
      description = "Get all accounts", // Mô tả hành động
      tags = { "Accounts" }, // Tag của hành động, nếu không có sẽ lấy tag của @Tag
      security = { // Danh sách bảo mật cho hành động
         @SecurityRequirement(name = "bearerAuth") // Api này yêu cầu bảo mật bearerAuth đã định nghĩa ở @SecuritySchemes với name là bearerAuth
      },
      responses = { // Danh sách các response
         @ApiResponse( // Response 1
            responseCode = "200", // Mã response
            description = "Successful operation" // Mô tả response
         ),
         @ApiResponse( // Response 2
            responseCode = "401", // Mã response
            description = "Unauthorized" // Mô tả response
         )
      }
   )
}
```

## 6. Sử dụng `@Schema`, `@Content` để định nghĩa thông tin chi tiết cho các đối tượng
Chúng ta có thể sử dụng `@Schema` để định nghĩa thông tin chi tiết cho các đối tượng bằng cách thêm annotation này vào các đối tượng.

Thuộc tính `implementation` của `@Schema` được sử dụng để định nghĩa đối tượng là `Exception`.

`@Content` được sử dụng để định nghĩa thông tin chi tiết cho các đối tượng trong `@ApiResponse`.

>AccountDTO.java
```java
...
@Schema( // Định nghĩa thông tin cho đối tượng
   name = "AccountDTO", // Tên đối tượng
   description = "AccountDTO", // Mô tả đối tượng
)
public class AccountDTO {
   @Schema( // Định nghĩa thông tin cho thuộc tính
      description = "Account",
      example = "1" // Giá trị mẫu
   )
   ...
}
```

>AccountController.java
```java
...
@Operation( // Định nghĩa thông tin cho hành động API
   summary = "Get all accounts", // Tóm tắt hành động
   description = "Get all accounts", // Mô tả hành động
   tags = { "Accounts" }, // Tag của hành động, nếu không có sẽ lấy tag của @Tag
   security = { // Danh sách bảo mật cho hành động
      @SecurityRequirement(name = "bearerAuth") // Api này yêu cầu bảo mật bearerAuth đã định nghĩa ở @SecuritySchemes với name là bearerAuth
   },
   responses = { // Danh sách các response
      @ApiResponse(
         responseCode = "500", // Mã response
         description = "Internal Server Error", // Mô tả response
         content = @Content( // Định nghĩa thông tin cho đối tượng
            schema = @Schema( // Định nghĩa thông tin cho đối tượng
               implementation = Exception.class // Đối tượng là Exception
            )
         )
      )
   }
)
```