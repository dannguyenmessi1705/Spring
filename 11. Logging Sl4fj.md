# Logging Sl4fj
## 1. Giới thiệu
Trong bài viết này, chúng ta sẽ tìm hiểu về thư viện `slf4j` (Simple Logging Facade for Java) để ghi log trong ứng dụng Java.

`slf4j` là một facade logging API cho Java. Nó cung cấp một API đơn giản để ghi log trong ứng dụng Java. `slf4j` không phải là một framework logging mà nó chỉ là một facade logging API. Nó cung cấp một API chung cho các framework logging khác như `log4j`, `logback`, `java.util.logging`,...

## 2. Cấu hình mức độ log
Chúng ta có thể cấu hình `log level` cho ứng dụng thông qua file `application.properties` hoặc `application.yml`.

Có 5 mức độ log:
- `TRACE`: Mức độ log thấp nhất, dùng để ghi log chi tiết nhất.
- `DEBUG`: Mức độ log thấp, dùng để ghi log chi tiết.
- `INFO`: Mức độ log thông tin, dùng để ghi log thông tin.
- `WARN`: Mức độ log cảnh báo, dùng để ghi log cảnh báo.
- `ERROR`: Mức độ log lỗi, dùng để ghi log lỗi.

> Nếu chúng ta cấu hình mức độ log là `INFO`, thì tất cả các log ở mức `INFO`, `WARN`, `ERROR` sẽ được ghi log, còn `DEBUG` và `TRACE` sẽ không được ghi log.

>VD: `application.properties`
```properties
# Logging cho toàn bộ framework Spring
logging.level.org.springframework=debug
# Cấu hình mức độ log cho ứng dụng (thay org.example.demo bằng package của ứng dụng)
logging.level.com.example.demo=info
```

Mặc định nó sẽ lắng nghe logger ở lớp info, để cho nó về lớp trace to nhất thì thay đổi `logging.level.root={loại log}` ở `application.properties`

Để log ra ` file ` thì thêm `logging.file={đường dẫn file}` ở `application.properties (classpath:logs/app.log)`

Tạo file cấu hình `logback-spring.xml` để `cấu hình logger thay vì cấu hình trong application.properties` (src/main/resources/logback-spring.xml)

Các định dạng của logger:
- `%d{yyyy-MM-dd HH:mm:ss.SSS}` : thời gian log
- `${PID}` : process id
- `$-5level` : In ra tất cả các log có level từ trace đến error
- `%5p` : loại log (trace, debug, info, warn, error)
- `%logger`{36} : tên class log (36 ký tự) 
- `%t` : thread
- `%c` : class
- `%M` : method
- `%L` : line
- `%msg` : message chính
- `%n` : xuống dòng
- `%ex` : log ra exception
- `%X` : log ra các thông tin trong MDC (Mapped Diagnostic Context) dùng để lưu trữ thông tin trong quá trình xử lý request
    
>VD: 
```bash
%d{yyyy-MM-dd HH:mm:ss.SSS} ${PID:-} $-5level %logger{36} %t %c %M %L %msg %n %ex
```

## 3. Sử dụng `slf4j` trong ứng dụng Java
Sau khi cấu hình mức độ log, chúng ta sử dụng `slf4j` trong ứng dụng Java như sau:

> `Controller.java`
```java
package com.example.demo;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HelloController {
    private static final Logger logger = LoggerFactory.getLogger(getClass()); // Khai báo Logger, lấy class hiện tại để ghi log
    @GetMapping("/hello")
    public String hello() {
    logger.info("The log is {}", "hello"); // Ghi log ở mức INFO, log message là "The log is hello"
        return "Hello World!";
    }
}
```


