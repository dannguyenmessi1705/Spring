# Sử dụng PostConstruct và PreDestroy trong Spring
## 1. Giới thiệu
Trong Spring Framework, chúng ta có thể sử dụng Annotation `@PostConstruct` và `@PreDestroy` để quản lý vòng đời của các Bean.

- **@PostConstruct**: Đánh dấu một phương thức sẽ được gọi ngay sau khi Bean được tạo ra (gọi ngay sau Constructor).
- **@PreDestroy**: Đánh dấu một phương thức sẽ được gọi ngay trước khi Bean bị hủy (gọi trước khi Bean bị Garbage Collection).

## 2. Sử dụng PostConstruct và PreDestroy
Để sử dụng PostConstruct và PreDestroy, chúng ta có thể sử dụng Annotation `@PostConstruct` và `@PreDestroy` và đặt sau các phương thức cần sử dụng.

Ví dụ:
```java
package com.example.demo;

import jakarta.annotation.PostConstruct;
import jakarta.annotation.PreDestroy;
import org.springframework.stereotype.Component;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;

@Component
class ClassA {
    public void display() {
        System.out.println("Class A");
    }
}

@Component
class ClassB {
    //DI
    private final ClassA classA;
    public ClassB(ClassA classA) {
        this.classA = classA;
        System.out.println("All dependencies are injected");
    }

    @PostConstruct // Phương thức này sẽ được gọi ngay sau khi Bean được tạo ra, init() sẽ được gọi ngay sau Constructor
    public void init() {
        classA.display();
    }

    @PreDestroy // Phương thức này sẽ được gọi ngay trước khi Bean bị hủy, destroy() sẽ được gọi trước khi Bean bị Garbage Collection
    public void destroy() {
        System.out.println("Destroy Class B");
    }
}

@Configuration
@ComponentScan
class Main {
    public static void main(String[] args) {
        try (var context = new AnnotationConfigApplicationContext(Main.class)) {
            context.getBean(ClassB.class); // PostConstruct sẽ được gọi ngay sau khi Bean được tạo ra
        }
        // Sau khi context.close() được gọi, PreDestroy sẽ được gọi ngay trước khi Bean bị hủy
    }
}
```
## 3. Lợi ích khi sử dụng PostConstruct và PreDestroy
### 3.1. PostConstruct
- **Init Bean**: Sử dụng PostConstruct giúp chúng ta khởi tạo Bean ngay sau khi Bean được tạo ra, giúp chúng ta khởi tạo các giá trị mặc định cho Bean.
- **Inject Dependency**: Sử dụng PostConstruct giúp chúng ta inject các dependency ngay sau khi Bean được tạo ra, giúp chúng ta sử dụng các dependency ngay sau khi Bean được tạo ra.
- **Init Connection**: Sử dụng PostConstruct giúp chúng ta khởi tạo kết nối ngay sau khi Bean được tạo ra, giúp chúng ta sử dụng kết nối ngay sau khi Bean được tạo ra. (Database connection, Socket connection, ...)

### 3.2. PreDestroy
- **Close Connection**: Sử dụng PreDestroy giúp chúng ta đóng kết nối ngay trước khi Bean bị hủy, giúp chúng ta đóng kết nối ngay trước khi Bean bị hủy. (Database connection, Socket connection, ...)
- **Destroy Bean**: Sử dụng PreDestroy giúp chúng ta hủy Bean ngay trước khi Bean bị hủy
- **Clean Up**: Sử dụng PreDestroy giúp chúng ta dọn dẹp các resource không cần thiết ngay trước khi Bean bị hủy, giúp chúng ta dọn dẹp các resource không cần thiết ngay trước khi Bean bị hủy.
